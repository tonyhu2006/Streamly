<!--
  Copyright 2018 LNFWebsite

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!doctype html>
<html>
<head>
  <title>Streamly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Streamly - ç°ä»£åŒ–çš„åœ¨çº¿è§†é¢‘æµåª’ä½“æ’­æ”¾å™¨ï¼Œæ”¯æŒ YouTube è§†é¢‘æœç´¢å’Œæ’­æ”¾ï¼Œæä¾›ä¼˜é›…çš„ç”¨æˆ·ç•Œé¢å’Œæµç•…çš„æ’­æ”¾ä½“éªŒã€‚" />
  
  <!-- ç°ä»£åŒ–å­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- å¤–éƒ¨æ ·å¼åº“ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@6/css/all.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" type="text/css" />
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" type="text/css" />

  <!-- Icon Stuff -->
  <link rel="shortcut icon" id="favicon" href="res/img/favicon.png" type="image/x-icon" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-startup-image" href="res/img/icon.png">
  <link rel="apple-touch-icon" href="res/img/icon.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="128x128" href="res/img/icon.png">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" sizes="196x196" href="res/img/icon.png">
  <link rel="shortcut icon" sizes="128x128" href="res/img/icon.png">
  
  <!-- Meta tags for Open Graph Protocol -->
  <meta property="og:title" id="ogTitle" content="Streamly - ç°ä»£åŒ–è§†é¢‘æµåª’ä½“æ’­æ”¾å™¨" />
  <meta property="og:url" content="https://lnfwebsite.github.io/Streamly" />
  <meta property="og:image" content="https://raw.githubusercontent.com/LNFWebsite/Streamly/master/res/img/icon.png" />
  
  <!-- CSS Stylesheet -->
  <link rel="stylesheet" href="res/css/styles.css" type="text/css" />
  <link rel="stylesheet" href="res/css/modern-theme.css" type="text/css" />
  <!--<link rel="stylesheet" href="res/css/sbs.css" type="text/css" />-->

  <!-- External scripts -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  <!--<script src="https://cdn.jsdelivr.net/gh/urin/jquery.balloon.js@1/jquery.balloon.min.js"></script>-->
</head>
<body>
  <div id="dataFramesContainer"></div>
  <header>
    <h1 id="title">
      <a href="">
        <img id="logo" src="https://raw.githubusercontent.com/LNFWebsite/Streamly/master/res/img/logo/logo_streamly_color/logo_streamly_color_low_res.png" />
      </a>
    </h1>
    <div id="inputBoxContainer">
      <form action="javascript:input(0);" method="get" id="searchForm">
        <div class="search-input-wrapper">
          <input type="text" id="inputBox" placeholder="ğŸ¬ æœç´¢è§†é¢‘ã€ç”µå½±ã€çºªå½•ç‰‡æˆ–é¢‘é“..." />
          <button type="submit" id="searchButton" class="search-btn" title="å¼€å§‹æœç´¢">
            <i class="fas fa-search"></i>
          </button>
        </div>
      </form>
      <div id="searchProgress">
        <div class="spinner">
          <div class="bounce1"></div>
          <div class="bounce2"></div>
          <div class="bounce3"></div>
        </div>
      </div>
    </div>
    <button id="playlistManagerButton" onclick="togglePlaylistManager();" title="æ’­æ”¾åˆ—è¡¨ç®¡ç†">ğŸ“‹</button>
    <span class="fas fa-columns headerButton" id="sbsButton" onclick="toggleSBS();" title="Toggle side-by-side view"></span>
    <span class="fas fa-cog headerButton" id="settingsButton" onclick="toggleMenu('settings');" title="Settings"></span>
    <span class="fas fa-exchange" id="stationIcon" onclick="disconnectStation();" title="Streamly Station is connected. Click to disconnect..."></span>
  </header>
  <div id="main">
    <div id="dropShadow"></div>
    <div id="dropOverlay"><p>(Drop videos/playlists anywhere on screen)</p></div>
    <div id="searchResultsWindow" class="floatingMenu">
      <h2>æœç´¢ç»“æœ:</h2>
      <div class="floatingMenuCloseButton" onclick="toggleMenu('searchResults');">å…³é—­</div>
      <div id="searchStatus" style="padding: 10px; font-style: italic; color: #666; display: none;"></div>
      <div id="searchResults" class="floatingMenuContents"></div>
    </div>
    <div id="settingsWindow" class="floatingMenu">
      <div class="floatingMenuCloseButton" onclick="toggleMenu('settings');">Ã—</div>
      <h2>ğŸ¬ Streamly è®¾ç½®</h2>
      <div class="floatingMenuContents">

        <!-- æ’­æ”¾è®¾ç½® -->
        <div class="settings-section">
          <h3>ğŸµ æ’­æ”¾è®¾ç½®</h3>
          <div class="setting-item">
            <label for="autoplayNext">è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€ä¸ªè§†é¢‘:</label>
            <input type="checkbox" id="autoplayNext" checked onchange="toggleAutoplayNext();">
          </div>
          <div class="setting-item">
            <label for="defaultVolume">é»˜è®¤éŸ³é‡:</label>
            <input type="range" id="defaultVolume" min="0" max="100" value="80" onchange="setDefaultVolume(this.value);">
            <span id="volumeValue">80%</span>
          </div>
          <div class="setting-item">
            <label for="playbackQuality">é»˜è®¤æ’­æ”¾è´¨é‡:</label>
            <select id="playbackQuality" onchange="setPlaybackQuality(this.value);">
              <option value="auto">è‡ªåŠ¨</option>
              <option value="hd1080">1080p</option>
              <option value="hd720">720p</option>
              <option value="large">480p</option>
              <option value="medium">360p</option>
            </select>
          </div>
        </div>

        <!-- ç•Œé¢è®¾ç½® -->
        <div class="settings-section">
          <h3>ğŸ¨ ç•Œé¢è®¾ç½®</h3>
          <div class="setting-item">
            <label for="SBStoggle">åˆ†å±æ˜¾ç¤ºæ¨¡å¼:</label>
            <input type="checkbox" id="SBStoggle" onchange="toggleSBS();">
          </div>
          <div class="setting-item">
            <label for="darkMode">æ·±è‰²ä¸»é¢˜:</label>
            <input type="checkbox" id="darkMode" checked onchange="toggleDarkMode();">
          </div>
          <div class="setting-item">
            <label for="showThumbnails">æ˜¾ç¤ºè§†é¢‘ç¼©ç•¥å›¾:</label>
            <input type="checkbox" id="showThumbnails" checked onchange="toggleThumbnails();">
          </div>
          <div class="setting-item">
            <label for="zenModeToggle">ä¸“æ³¨æ¨¡å¼ (éšè—å¹²æ‰°å…ƒç´ ):</label>
            <input type="checkbox" id="zenModeToggle" onchange="toggleZen();">
          </div>
        </div>

        <!-- æœç´¢è®¾ç½® -->
        <div class="settings-section">
          <h3>ğŸ” æœç´¢è®¾ç½®</h3>
          <div class="setting-item">
            <label for="searchClose">æ·»åŠ è§†é¢‘åè‡ªåŠ¨å…³é—­æœç´¢çª—å£:</label>
            <input type="checkbox" id="searchClose" onchange="toggleSearchClose();">
            <small>æç¤º: æŒ‰ Shift+\ å¯ä¸´æ—¶åè½¬æ­¤è®¾ç½®</small>
          </div>
          <div class="setting-item">
            <label for="searchResults">æœç´¢ç»“æœæ•°é‡:</label>
            <select id="searchResults" onchange="setSearchResultsCount(this.value);">
              <option value="10">10ä¸ªç»“æœ</option>
              <option value="20" selected>20ä¸ªç»“æœ</option>
              <option value="30">30ä¸ªç»“æœ</option>
              <option value="50">50ä¸ªç»“æœ</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="safeSearch">å®‰å…¨æœç´¢:</label>
            <select id="safeSearch" onchange="setSafeSearch(this.value);">
              <option value="moderate" selected>ä¸­ç­‰</option>
              <option value="strict">ä¸¥æ ¼</option>
              <option value="none">å…³é—­</option>
            </select>
          </div>
        </div>

        <!-- æ’­æ”¾åˆ—è¡¨è®¾ç½® -->
        <div class="settings-section">
          <h3>ğŸ“‹ æ’­æ”¾åˆ—è¡¨è®¾ç½®</h3>
          <div class="setting-item">
            <label for="autoplayListOverride">ä½¿ç”¨ YouTube æ··åˆæ’­æ”¾åˆ—è¡¨ä½œä¸ºç”µå°:</label>
            <input type="checkbox" id="autoplayListOverride" onchange="toggleAutoplayListOverride();">
          </div>
          <div class="setting-item">
            <label for="shuffleMode">é»˜è®¤éšæœºæ’­æ”¾:</label>
            <input type="checkbox" id="shuffleMode" onchange="toggleShuffleMode();">
          </div>
          <div class="setting-item">
            <label for="repeatMode">é»˜è®¤é‡å¤æ’­æ”¾:</label>
            <select id="repeatMode" onchange="setRepeatMode(this.value);">
              <option value="none">ä¸é‡å¤</option>
              <option value="one">å•æ›²å¾ªç¯</option>
              <option value="all">åˆ—è¡¨å¾ªç¯</option>
            </select>
          </div>
        </div>

        <!-- é«˜çº§è®¾ç½® -->
        <div class="settings-section">
          <h3>âš™ï¸ é«˜çº§è®¾ç½®</h3>
          <div class="setting-item">
            <label for="preloadVideos">é¢„åŠ è½½è§†é¢‘:</label>
            <input type="checkbox" id="preloadVideos" checked onchange="togglePreloadVideos();">
            <small>æé«˜æ’­æ”¾æµç•…åº¦ï¼Œä½†ä¼šå¢åŠ æ•°æ®ä½¿ç”¨é‡</small>
          </div>
          <div class="setting-item">
            <label for="keyboardShortcuts">å¯ç”¨é”®ç›˜å¿«æ·é”®:</label>
            <input type="checkbox" id="keyboardShortcuts" checked onchange="toggleKeyboardShortcuts();">
          </div>
          <div class="setting-item">
            <label for="analyticsEnabled">ä½¿ç”¨ç»Ÿè®¡ (åŒ¿å):</label>
            <input type="checkbox" id="analyticsEnabled" onchange="toggleAnalytics();">
            <small>å¸®åŠ©æ”¹è¿› Streamly</small>
          </div>
        </div>

        <!-- æ•°æ®ç®¡ç† -->
        <div class="settings-section">
          <h3>ğŸ’¾ æ•°æ®ç®¡ç†</h3>
          <div class="setting-item">
            <button class="settings-button" onclick="exportSettings();">å¯¼å‡ºè®¾ç½®</button>
            <button class="settings-button" onclick="importSettings();">å¯¼å…¥è®¾ç½®</button>
          </div>
          <div class="setting-item">
            <button class="settings-button" onclick="clearCache();">æ¸…é™¤ç¼“å­˜</button>
            <button class="settings-button danger" onclick="resetSettings();">é‡ç½®æ‰€æœ‰è®¾ç½®</button>
          </div>
        </div>

        <!-- å…³äºä¿¡æ¯ -->
        <div class="settings-section">
          <h3>â„¹ï¸ å…³äº Streamly</h3>
          <div class="about-info">
            <p><strong>ç‰ˆæœ¬:</strong> 2.0.0</p>
            <p><strong>æ„å»ºæ—¥æœŸ:</strong> <span id="buildDate">2024-01-01</span></p>
            <p><strong>å¼€æºé¡¹ç›®:</strong> <a href="https://github.com/tonyhu2006/Streamly" target="_blank">GitHub</a></p>
            <p><strong>è®¸å¯è¯:</strong> Apache 2.0</p>
          </div>
        </div>

      </div>
    </div>

    <!-- æ’­æ”¾åˆ—è¡¨ç®¡ç†çª—å£ -->
    <div id="playlistManagerWindow" class="floatingMenu" style="display: none;">
      <div class="floatingMenuCloseButton" onclick="togglePlaylistManager();">Ã—</div>
      <h2>ğŸ“‹ æ’­æ”¾åˆ—è¡¨ç®¡ç†</h2>
      <div class="floatingMenuContents">

        <!-- å½“å‰çŠ¶æ€ -->
        <div class="playlist-section">
          <h3>å½“å‰çŠ¶æ€</h3>
          <div class="current-status">
            <div class="status-item">
              <span class="status-label">å½“å‰æ¨¡å¼:</span>
              <span id="currentModeDisplay">ä¸´æ—¶æ’­æ”¾é˜Ÿåˆ—</span>
            </div>
            <div class="status-item">
              <span class="status-label">é˜Ÿåˆ—ä¸­è§†é¢‘:</span>
              <span id="currentQueueCount">0</span>
            </div>
            <div class="status-item">
              <span class="status-label">æœ¬åœ°æ’­æ”¾åˆ—è¡¨:</span>
              <span id="localPlaylistCount">0</span>
            </div>
          </div>
        </div>

        <!-- å¿«é€Ÿæ“ä½œ -->
        <div class="playlist-section">
          <h3>å¿«é€Ÿæ“ä½œ</h3>
          <div class="quick-actions">
            <button class="action-button" onclick="saveCurrentQueueAsPlaylist();">
              <i class="fas fa-save"></i> ä¿å­˜å½“å‰é˜Ÿåˆ—
            </button>
            <button class="action-button" onclick="showCreatePlaylistDialog();">
              <i class="fas fa-plus"></i> åˆ›å»ºæ–°æ’­æ”¾åˆ—è¡¨
            </button>
            <button class="action-button secondary" onclick="switchPlaylist('temp');">
              <i class="fas fa-list"></i> åˆ‡æ¢åˆ°ä¸´æ—¶é˜Ÿåˆ—
            </button>
          </div>
        </div>

        <!-- æœ¬åœ°æ’­æ”¾åˆ—è¡¨ -->
        <div class="playlist-section">
          <h3>æœ¬åœ°æ’­æ”¾åˆ—è¡¨</h3>
          <div id="localPlaylistsList" class="playlists-container">
            <!-- æœ¬åœ°æ’­æ”¾åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>

        <!-- ä¸´æ—¶æ’­æ”¾åˆ—è¡¨ï¼ˆåŸæœ‰åŠŸèƒ½ï¼‰ -->
        <div class="playlist-section">
          <h3>ä¸´æ—¶æ’­æ”¾åˆ—è¡¨</h3>
          <div class="create-playlist-form">
            <input type="text" id="newPlaylistName" placeholder="è¾“å…¥æ’­æ”¾åˆ—è¡¨åç§°..." maxlength="50">
            <textarea id="newPlaylistDescription" placeholder="æè¿°ï¼ˆå¯é€‰ï¼‰..." rows="2" maxlength="200"></textarea>
            <button class="action-button" onclick="createNewPlaylist();">
              <i class="fas fa-plus"></i> åˆ›å»ºä¸´æ—¶æ’­æ”¾åˆ—è¡¨
            </button>
          </div>

          <div id="playlistsList" class="playlists-container">
            <!-- ä¸´æ—¶æ’­æ”¾åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>

      </div>
    </div>

    <!-- æ’­æ”¾åˆ—è¡¨é€‰æ‹©å¼¹çª— -->
    <div id="playlistSelectorModal" class="modal" style="display: none;" onclick="if(event.target === this) { closePlaylistSelector(); }">
      <div class="modal-content" onclick="event.stopPropagation();">
        <div class="modal-header">
          <h3>é€‰æ‹©æ’­æ”¾åˆ—è¡¨</h3>
          <button class="modal-close" onclick="closePlaylistSelector();">Ã—</button>
        </div>
        <div class="modal-body">
          <div id="playlistSelectorList" class="playlist-selector-list">
            <!-- æ’­æ”¾åˆ—è¡¨é€‰é¡¹å°†åœ¨è¿™é‡Œç”Ÿæˆ -->
          </div>
        </div>
        <div class="modal-footer">
          <button class="action-button secondary" onclick="closePlaylistSelector();">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
    <form action="javascript:input(2);" method="get">
      <div id="playlistSelector" class="playlist-selector">
        <select id="currentPlaylistSelect" onchange="switchPlaylist(this.value);" title="é€‰æ‹©æ’­æ”¾åˆ—è¡¨">
          <option value="temp">ğŸ“ ä¸´æ—¶æ’­æ”¾é˜Ÿåˆ—</option>
        </select>
        <button id="newPlaylistBtn" onclick="showCreatePlaylistDialog();" title="åˆ›å»ºæ–°æ’­æ”¾åˆ—è¡¨">â•</button>
        <button id="saveQueueBtn" onclick="saveCurrentQueueAsPlaylist();" title="ä¿å­˜å½“å‰é˜Ÿåˆ—ä¸ºæ’­æ”¾åˆ—è¡¨">ğŸ’¾</button>
        <button id="managePlaylistsBtn" onclick="togglePlaylistManager();" title="ç®¡ç†æ’­æ”¾åˆ—è¡¨">ğŸ“‹</button>
      </div>
    </form>

    <!-- æ¬¢è¿æ¶ˆæ¯ -->
    <div id="welcomeMessage" class="welcome-message" style="display: none;">
      <h2>ğŸ¬ æ¬¢è¿ä½¿ç”¨ Streamly 2.0</h2>
      <p>å…¨æ–°çš„æœåŠ¡å™¨ç«¯è§†é¢‘æµåª’ä½“æ’­æ”¾å™¨</p>
      <p>âœ¨ åœ¨ä¸Šæ–¹æœç´¢æ¡†ä¸­è¾“å…¥è§†é¢‘åã€é¢‘é“æˆ–å…³é”®è¯å¼€å§‹æ‚¨çš„è§‚å½±ä¹‹æ—…</p>
      <p>ğŸ¯ æ”¯æŒæ™ºèƒ½æœç´¢ã€é«˜è´¨é‡æ’­æ”¾å’Œæ’­æ”¾åˆ—è¡¨ç®¡ç†</p>
      <p>ğŸš€ æ— éœ€å¤–éƒ¨æµè§ˆå™¨ï¼Œäº«å—çº¯å‡€çš„è§†é¢‘ä½“éªŒ</p>
    </div>

    <table id="videosTable"></table>
    <div id="links">
      <a href="/guide.html">ä½¿ç”¨æŒ‡å—</a> |
      <a href="https://github.com/LNFWebsite/Streamly/wiki/Playlists" target="_blank">æ’­æ”¾åˆ—è¡¨å¸®åŠ©</a> |
      <a href="https://lnfwebsite.github.io/Streamly-Import/" target="_blank">å¯¼å…¥æ’­æ”¾åˆ—è¡¨</a> |
      <a href="https://www.reddit.com/r/StreamlyReddit/" target="_blank">StreamlyReddit</a>
      <br>
      <span style="color:#4CAF50;">âœ“ æœåŠ¡å™¨ç«¯è§†é¢‘æœç´¢å’Œæ’­æ”¾åŠŸèƒ½å·²å¯ç”¨</span> |
      <span style="color:#2196F3;">æ”¯æŒå†…ç½®è§†é¢‘æµåª’ä½“æ’­æ”¾ï¼Œæ— éœ€å¤–éƒ¨æµè§ˆå™¨</span>
    </div>

    <!-- å¿«é€Ÿåˆ›å»ºæ’­æ”¾åˆ—è¡¨å¯¹è¯æ¡† -->
    <div id="quickCreatePlaylistModal" class="modal" style="display: none;" onclick="if(event.target === this) { closeQuickCreateDialog(); }">
      <div class="modal-content" onclick="event.stopPropagation();">
        <div class="modal-header">
          <h3>ğŸ“‹ åˆ›å»ºæ–°æ’­æ”¾åˆ—è¡¨</h3>
          <button class="modal-close" onclick="closeQuickCreateDialog();">Ã—</button>
        </div>
        <div class="modal-body">
          <div class="quick-create-form">
            <input type="text" id="quickPlaylistName" placeholder="æ’­æ”¾åˆ—è¡¨åç§°..." maxlength="50">
            <textarea id="quickPlaylistDescription" placeholder="æè¿°ï¼ˆå¯é€‰ï¼‰..." rows="2" maxlength="200"></textarea>
          </div>

          <!-- å­˜å‚¨ä¿¡æ¯åŒºåŸŸ -->
          <div class="storage-info-section">
            <div class="storage-info-header" onclick="toggleStorageInfo();">
              <h4>ğŸ“ å­˜å‚¨ä½ç½®ä¿¡æ¯</h4>
              <button type="button" class="info-toggle-btn">
                <i class="fas fa-chevron-down"></i>
              </button>
            </div>

            <div id="storageInfoContent" class="storage-info-content" style="display: none;">
              <!-- å­˜å‚¨è·¯å¾„ä¿¡æ¯ -->
              <div class="storage-path-info">
                <h5>ğŸ’¾ æœ¬åœ°å­˜å‚¨è·¯å¾„</h5>
                <div class="path-display">
                  <code id="storagePath">æ£€æµ‹ä¸­...</code>
                  <button type="button" class="copy-path-btn" onclick="copyStoragePath();" title="å¤åˆ¶è·¯å¾„">
                    <i class="fas fa-copy"></i>
                  </button>
                </div>
                <div class="storage-key-info">
                  <small><strong>å­˜å‚¨é”®å:</strong> <code>streamly-local-playlists</code></small>
                </div>
              </div>

              <!-- å­˜å‚¨é™åˆ¶ä¿¡æ¯ -->
              <div class="storage-limits">
                <h5>ğŸ“Š å­˜å‚¨é™åˆ¶</h5>
                <ul>
                  <li><strong>localStorageå®¹é‡é™åˆ¶:</strong> é€šå¸¸ä¸º 5-10MB</li>
                  <li><strong>æ•°æ®æŒä¹…æ€§:</strong> é™¤éç”¨æˆ·æ‰‹åŠ¨æ¸…é™¤æˆ–ä½¿ç”¨éšç§æ¨¡å¼ï¼Œå¦åˆ™æ•°æ®æ°¸ä¹…ä¿å­˜</li>
                  <li><strong>åŸŸåéš”ç¦»:</strong> åªèƒ½åœ¨ç›¸åŒåŸŸåä¸‹è®¿é—®æ•°æ®</li>
                </ul>
              </div>

              <!-- éšç§å’Œå®‰å…¨ä¿¡æ¯ -->
              <div class="privacy-security">
                <h5>ğŸ”’ éšç§å’Œå®‰å…¨</h5>
                <ul class="security-list">
                  <li class="security-good">âœ… æ•°æ®å®Œå…¨å­˜å‚¨åœ¨ç”¨æˆ·æœ¬åœ°æµè§ˆå™¨ä¸­</li>
                  <li class="security-good">âœ… ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨</li>
                  <li class="security-good">âœ… åªæœ‰å½“å‰ç½‘ç«™å¯ä»¥è®¿é—®è¿™äº›æ•°æ®</li>
                  <li class="security-warning">âš ï¸ æ¸…é™¤æµè§ˆå™¨æ•°æ®ä¼šåˆ é™¤æ‰€æœ‰æ’­æ”¾åˆ—è¡¨</li>
                  <li class="security-warning">âš ï¸ éšç§æ¨¡å¼ä¸‹çš„æ•°æ®åœ¨å…³é—­æµè§ˆå™¨åä¼šä¸¢å¤±</li>
                </ul>
              </div>

              <!-- å¤‡ä»½å»ºè®® -->
              <div class="backup-suggestion">
                <h5>ğŸ’¾ å¤‡ä»½å»ºè®®</h5>
                <p>å»ºè®®å®šæœŸå¯¼å‡ºæ’­æ”¾åˆ—è¡¨æ•°æ®è¿›è¡Œå¤‡ä»½ï¼Œå¯é€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æˆ–åº”ç”¨å†…å¯¼å‡ºåŠŸèƒ½å®ç°ã€‚</p>
                <button type="button" class="backup-btn" onclick="showBackupInstructions();">
                  <i class="fas fa-download"></i> æŸ¥çœ‹å¤‡ä»½æ–¹æ³•
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="action-button" onclick="createQuickPlaylist();">
            <i class="fas fa-plus"></i> åˆ›å»ºæ’­æ”¾åˆ—è¡¨
          </button>
          <button class="action-button secondary" onclick="closeQuickCreateDialog();">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <div id="previousVideo" onclick="backVideo();" title="Back">
      <div class="videoNameContainer">
        <p class="videoName"></p>
      </div>
      <div class="videoImageContainer">
        <div class="videoImageWrapper">
          <img class="videoImage" src="" />
          <span class="fas fa-backward"></span>
          <p class="videoTime"></p>
        </div>
      </div>
    </div>
    <div id="playlistInterface">
      <div id="youtubeContainer">
        <span id="remotePauseIcon" class="fas fa-play"></span>
        <div id="playerStatus" style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; z-index: 1000; display: none;"></div>
        <video id="videoPlayer" controls preload="metadata" style="width: 100%; height: 100%; display: none;">
          <source id="videoSource" src="" type="video/mp4">
          æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ HTML5 è§†é¢‘æ’­æ”¾ã€‚
        </video>
        <iframe id="youtube" src="" allowfullscreen style="display: none;"></iframe>
      </div>
      <div id="currentVideoTiming">
        <span id="currentTime">0:00</span>
        <span id="progressContainer">
          <span id="progress" style="width:0%;"></span>
        </span>
        <span id="videoTime">0:00</span>
      </div>
    </div>
    <div id="nextVideo" onclick="forwardVideo();" title="Forward">
      <div class="videoImageContainer">
        <div class="videoImageWrapper">
          <img class="videoImage" src="" />
          <span class="fas fa-forward"></span>
          <p class="videoTime"></p>
        </div>
      </div>
      <div class="videoNameContainer">
        <p class="videoName"></p>
      </div>
    </div>
    <div id="settings">
      <span class="fas fa-arrow-circle-right" onclick="playlistFeatures.playNext();" title="Added videos will play next"></span>
      <span class="fas fa-random" onclick="playlistFeatures.shuffle();" title="Playlist shuffle"></span>
      <span class="fas fa-redo-alt" onclick="playlistFeatures.repeat();" title="Playlist repeat"></span>
      <span class="fas fa-rss" onclick="playlistFeatures.autoplay();" title="Streamly Radio"></span>
      <span class="fab fa-reddit" id="ad" onclick="shareOnReddit();" title="Share playlist on Reddit"></span>
    </div>
  </footer>
  <!----
  <div id="dialog"><p>Hey everyone, unfortunately YouTube has sealed off one of their data sources which has rendered quick search and in-box search unusable. Right now I've switched back to pop-up search until I can find a better solution. Rest assured your playlists always were and continue to be safe. I apologize for this inconvenience.</p></div>
  <script>
  //this is a standard dialog box for jquery that can be used to non-annoyingly get messages to users on-load
  $("#dialog").dialog();
  </script>
  ---->
  <script src="res/js/front/initialize.js"></script>
  <script src="res/js/front/youtube.js"></script>
  <script src="res/js/front/videoplayer.js"></script>
  <script src="res/js/front/share.js"></script>
  <script src="res/js/front/events.js"></script>

  <script src="res/js/back/global.js"></script>
  <script src="res/js/back/base.js"></script>
  <script src="res/js/back/playlistBack.js"></script>
  <script src="res/js/back/playlistFront.js"></script>
  <script src="res/js/back/data.js"></script>
  <script src="res/js/back/progress.js"></script>
  <script src="res/js/back/input.js"></script>
  <script src="res/js/back/search.js"></script>
  <script src="res/js/back/radio.js"></script>
  <script src="res/js/back/station.js"></script>
  <script src="res/js/back/toggles.js"></script>
  <!--
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/front/initialize.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/front/youtube.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/front/share.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/front/events.min.js"></script>
  
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/global.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/base.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/playlistBack.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/playlistFront.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/data.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/progress.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/input.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/search.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/radio.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/station.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LNFWebsite/Streamly@gh-pages/res/js/back/toggles.min.js"></script>
  -->
  <!-- Start of StatCounter Code for Default Guide -->
  <script type="text/javascript">
  var sc_project=10543623;
  var sc_invisible=1;
  var sc_security="4c623aaf";
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="http://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="//c.statcounter.com/10543623/0/4c623aaf/1/" alt="Web
  Analytics"></a></div></noscript>
  <!-- End of StatCounter Code for Default Guide -->

  <!-- èƒŒæ™¯é€‰æ‹©å™¨ -->
  <script src="res/js/background-selector.js" type="text/javascript"></script>

  <!-- è®¾ç½®ç®¡ç†å™¨ -->
  <script src="res/js/settings-manager.js" type="text/javascript"></script>

  <!-- æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ -->
  <script src="res/js/playlist-manager.js" type="text/javascript"></script>

  <!-- æœ¬åœ°æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ -->
  <script src="res/js/local-playlist-manager.js" type="text/javascript"></script>

  <!-- ç¨³å®šçª—å£ç®¡ç†å™¨ -->
  <script src="res/js/stable-window-manager.js" type="text/javascript"></script>

  <!-- ç°ä»£åŒ–ç•Œé¢å¢å¼ºè„šæœ¬ -->
  <script>
    // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯ï¼ˆå¦‚æœæ’­æ”¾åˆ—è¡¨ä¸ºç©ºï¼‰
      function checkPlaylistEmpty() {
        const table = document.getElementById('videosTable');
        const welcomeMessage = document.getElementById('welcomeMessage');

        if (table && welcomeMessage) {
          if (table.children.length === 0) {
            welcomeMessage.style.display = 'block';
            welcomeMessage.classList.add('animate__animated', 'animate__fadeInUp');
          } else {
            welcomeMessage.style.display = 'none';
          }
        }
      }

      // åˆå§‹æ£€æŸ¥
      setTimeout(checkPlaylistEmpty, 1000);

      // ç›‘å¬è¡¨æ ¼å˜åŒ–
      const observer = new MutationObserver(checkPlaylistEmpty);
      const table = document.getElementById('videosTable');
      if (table) {
        observer.observe(table, { childList: true, subtree: true });
      }

      // æ·»åŠ æœç´¢æ¡†ç„¦ç‚¹æ•ˆæœ
      const inputBox = document.getElementById('inputBox');
      if (inputBox) {
        inputBox.addEventListener('focus', function() {
          this.parentElement.parentElement.style.transform = 'scale(1.02)';
        });

        inputBox.addEventListener('blur', function() {
          this.parentElement.parentElement.style.transform = 'scale(1)';
        });
      }

      // æ·»åŠ é¡µé¢åŠ è½½åŠ¨ç”»
      document.body.style.opacity = '0';
      document.body.style.transition = 'opacity 0.5s ease-in-out';

      setTimeout(function() {
        document.body.style.opacity = '1';
      }, 100);

      // æ·»åŠ æ»šåŠ¨æ•ˆæœ
      let lastScrollTop = 0;
      const header = document.querySelector('header');

      window.addEventListener('scroll', function() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

        if (scrollTop > lastScrollTop && scrollTop > 100) {
          // å‘ä¸‹æ»šåŠ¨
          header.style.transform = 'translateY(-100%)';
        } else {
          // å‘ä¸Šæ»šåŠ¨
          header.style.transform = 'translateY(0)';
        }

        lastScrollTop = scrollTop;
      });
    });

    // æœç´¢ç»“æœæ˜¾ç¤ºæ—¶éšè—æ¬¢è¿æ¶ˆæ¯
    function hideWelcomeMessage() {
      const welcomeMessage = document.getElementById('welcomeMessage');
      if (welcomeMessage) {
        welcomeMessage.style.display = 'none';
      }
    }

    // å…¨å±€å‡½æ•°ï¼Œä¾›å…¶ä»–è„šæœ¬è°ƒç”¨
    window.modernUI = {
      hideWelcomeMessage: hideWelcomeMessage
    };

    // æµ‹è¯•æ¨¡æ€æ¡†æ˜¾ç¤ºå‡½æ•°
    function testShowModal() {
      console.log('ğŸ”§ æµ‹è¯•æ˜¾ç¤ºæ¨¡æ€æ¡†...');

      // é¦–å…ˆéšè—footer
      const footer = document.querySelector('footer');
      if (footer) {
        footer.style.display = 'none';
        footer.style.visibility = 'hidden';
        footer.style.opacity = '0';
        footer.style.zIndex = '-1';
        console.log('âœ… å·²éšè—footeråŒºåŸŸ');
      }

      const modal = document.getElementById('quickCreatePlaylistModal');

      if (modal) {
        console.log('âœ… æ‰¾åˆ°æ¨¡æ€æ¡†å…ƒç´ ');
        modal.style.display = 'flex';
        modal.style.visibility = 'visible';
        modal.style.opacity = '1';
        modal.style.zIndex = '2147483647';
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100vw';
        modal.style.height = '100vh';
        modal.style.background = 'rgba(0, 0, 0, 0.8)';

        console.log('âœ… æ¨¡æ€æ¡†æ ·å¼å·²è®¾ç½®');

        // æ¸…ç©ºè¾“å…¥æ¡†
        const nameInput = document.getElementById('quickPlaylistName');
        const descInput = document.getElementById('quickPlaylistDescription');
        if (nameInput) nameInput.value = '';
        if (descInput) descInput.value = '';

        console.log('âœ… è¾“å…¥æ¡†å·²æ¸…ç©º');
      } else {
        console.error('âŒ æœªæ‰¾åˆ° quickCreatePlaylistModal å…ƒç´ ');
        alert('æœªæ‰¾åˆ°æ¨¡æ€æ¡†å…ƒç´ ï¼');
      }
    }

    // å…³é—­æ¨¡æ€æ¡†å‡½æ•°
    function closeQuickCreateDialog() {
      console.log('ğŸ”§ å…³é—­æ¨¡æ€æ¡†...');
      const modal = document.getElementById('quickCreatePlaylistModal');
      if (modal) {
        modal.style.display = 'none';

        // æ¢å¤æ’­æ”¾åŒºæ˜¾ç¤º
        const footer = document.querySelector('footer');
        if (footer) {
          footer.style.display = 'flex';
          footer.style.visibility = 'visible';
          footer.style.opacity = '1';
          footer.style.minHeight = '300px';
          footer.style.height = 'auto';
          footer.style.zIndex = '1000';

          console.log('âœ… æ’­æ”¾åŒºå·²æ¢å¤æ˜¾ç¤º');
        }

        console.log('âœ… æ¨¡æ€æ¡†å·²å…³é—­');
      }
    }

    // åˆ›å»ºæ’­æ”¾åˆ—è¡¨å‡½æ•°
    function createQuickPlaylist() {
      console.log('ğŸ”§ åˆ›å»ºæ’­æ”¾åˆ—è¡¨...');
      const nameInput = document.getElementById('quickPlaylistName');

      if (nameInput && nameInput.value.trim()) {
        alert('æ’­æ”¾åˆ—è¡¨ "' + nameInput.value + '" åˆ›å»ºæˆåŠŸï¼');
        closeQuickCreateDialog();
      } else {
        alert('è¯·è¾“å…¥æ’­æ”¾åˆ—è¡¨åç§°ï¼');
      }
    }

    // æ›´æ–°å­˜å‚¨è·¯å¾„ä¿¡æ¯
    function updateStoragePathInfo() {
      if (window.localPlaylistManager) {
        const storageInfo = window.localPlaylistManager.getLocalStoragePath();
        const pathElement = document.getElementById('storagePath');

        if (pathElement) {
          pathElement.textContent = storageInfo.path || 'æ— æ³•æ£€æµ‹è·¯å¾„';
          pathElement.title = `æµè§ˆå™¨: ${storageInfo.browser} | ç³»ç»Ÿ: ${storageInfo.os} | åŸŸå: ${storageInfo.domain}`;
        }
      }
    }

    // åˆ‡æ¢å­˜å‚¨ä¿¡æ¯æ˜¾ç¤º
    function toggleStorageInfo() {
      console.log('ğŸ”§ åˆ‡æ¢å­˜å‚¨ä¿¡æ¯æ˜¾ç¤º...');

      const content = document.getElementById('storageInfoContent');
      const toggleBtn = document.querySelector('.info-toggle-btn');

      console.log('ğŸ“‹ æ‰¾åˆ°å…ƒç´ :', {
        content: !!content,
        toggleBtn: !!toggleBtn,
        currentDisplay: content ? content.style.display : 'null'
      });

      if (content && toggleBtn) {
        const isHidden = content.style.display === 'none' || content.style.display === '';

        if (isHidden) {
          console.log('ğŸ“– æ˜¾ç¤ºå­˜å‚¨ä¿¡æ¯å†…å®¹');
          content.style.display = 'block';
          content.style.visibility = 'visible';
          content.style.opacity = '1';
          content.style.maxHeight = '1000px';
          toggleBtn.classList.add('expanded');

          // æ£€æŸ¥å†…å®¹æ˜¯å¦å®Œæ•´æ˜¾ç¤ºå¹¶ç¡®ä¿æœ€åä¸€é¡¹å¯è§
          setTimeout(() => {
            const allItems = content.querySelectorAll('li');
            console.log('ğŸ“‹ å­˜å‚¨ä¿¡æ¯é¡¹ç›®æ•°é‡:', allItems.length);

            const lastItem = allItems[allItems.length - 1];
            const modalBody = content.closest('.modal-body');

            if (lastItem && modalBody) {
              // ç¡®ä¿æœ‰è¶³å¤Ÿçš„åº•éƒ¨é—´è·
              const storageSection = content.closest('.storage-info-section');
              if (storageSection) {
                storageSection.style.paddingBottom = '20px';
              }

              // æ£€æŸ¥æœ€åä¸€é¡¹æ˜¯å¦å®Œå…¨å¯è§
              setTimeout(() => {
                const rect = lastItem.getBoundingClientRect();
                const modalRect = modalBody.getBoundingClientRect();
                const isFullyVisible = rect.bottom <= (modalRect.bottom - 10); // ç•™10pxç¼“å†²

                console.log('ğŸ“‹ æœ€åä¸€é¡¹ä¿¡æ¯:', {
                  text: lastItem.textContent,
                  fullyVisible: isFullyVisible,
                  itemBottom: rect.bottom,
                  modalBottom: modalRect.bottom,
                  buffer: modalRect.bottom - rect.bottom
                });

                // å¦‚æœæœ€åä¸€é¡¹ä¸å®Œå…¨å¯è§ï¼Œè°ƒæ•´æ»šåŠ¨ä½ç½®
                if (!isFullyVisible) {
                  const scrollOffset = rect.bottom - modalRect.bottom + 20; // é¢å¤–20pxç¼“å†²
                  modalBody.scrollTop += scrollOffset;
                  console.log('ğŸ“œ è°ƒæ•´æ»šåŠ¨ä½ç½®:', scrollOffset);
                }
              }, 200);
            }
          }, 100);
        } else {
          console.log('ğŸ“– éšè—å­˜å‚¨ä¿¡æ¯å†…å®¹');
          content.style.display = 'none';
          content.style.visibility = 'hidden';
          content.style.opacity = '0';
          toggleBtn.classList.remove('expanded');
        }

        console.log('âœ… åˆ‡æ¢å®Œæˆï¼Œå½“å‰çŠ¶æ€:', content.style.display);
      } else {
        console.error('âŒ æœªæ‰¾åˆ°å¿…è¦çš„å…ƒç´ ');
        if (!content) console.error('âŒ æœªæ‰¾åˆ° storageInfoContent å…ƒç´ ');
        if (!toggleBtn) console.error('âŒ æœªæ‰¾åˆ° info-toggle-btn å…ƒç´ ');
      }
    }

    // å¤åˆ¶å­˜å‚¨è·¯å¾„
    function copyStoragePath() {
      const pathElement = document.getElementById('storagePath');
      if (pathElement) {
        const path = pathElement.textContent;

        if (navigator.clipboard) {
          navigator.clipboard.writeText(path).then(() => {
            showCopyFeedback('è·¯å¾„å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
          }).catch(() => {
            fallbackCopyText(path);
          });
        } else {
          fallbackCopyText(path);
        }
      }
    }

    // å¤‡ç”¨å¤åˆ¶æ–¹æ³•
    function fallbackCopyText(text) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      textArea.style.position = 'fixed';
      textArea.style.opacity = '0';
      document.body.appendChild(textArea);
      textArea.select();

      try {
        document.execCommand('copy');
        showCopyFeedback('è·¯å¾„å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
      } catch (err) {
        showCopyFeedback('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
      }

      document.body.removeChild(textArea);
    }

    // æ˜¾ç¤ºå¤åˆ¶åé¦ˆ
    function showCopyFeedback(message, type = 'success') {
      const feedback = document.createElement('div');
      feedback.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: ${type === 'success' ? '#4caf50' : '#f44336'};
        color: white;
        padding: 8px 16px;
        border-radius: 6px;
        z-index: 100001;
        font-size: 12px;
        animation: fadeInOut 2s ease;
      `;
      feedback.textContent = message;

      document.body.appendChild(feedback);

      setTimeout(() => {
        if (document.body.contains(feedback)) {
          document.body.removeChild(feedback);
        }
      }, 2000);
    }

    // æ˜¾ç¤ºå¤‡ä»½è¯´æ˜
    function showBackupInstructions() {
      const instructions = `
ğŸ“‹ æ’­æ”¾åˆ—è¡¨å¤‡ä»½æ–¹æ³•ï¼š

æ–¹æ³•ä¸€ï¼šé€šè¿‡å¼€å‘è€…å·¥å…·
1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
2. è½¬åˆ° Application æ ‡ç­¾é¡µ
3. åœ¨å·¦ä¾§æ‰¾åˆ° Local Storage
4. å±•å¼€ç½‘ç«™åŸŸå
5. æ‰¾åˆ° 'streamly-local-playlists' é”®
6. å¤åˆ¶å…¶å€¼å¹¶ä¿å­˜åˆ°æ–‡ä»¶

æ–¹æ³•äºŒï¼šé€šè¿‡æ§åˆ¶å°
1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
2. è½¬åˆ° Console æ ‡ç­¾é¡µ
3. è¾“å…¥ï¼šlocalStorage.getItem('streamly-local-playlists')
4. å¤åˆ¶è¾“å‡ºç»“æœå¹¶ä¿å­˜

æ¢å¤æ–¹æ³•ï¼š
å°†å¤‡ä»½çš„æ•°æ®é€šè¿‡æ§åˆ¶å°è¾“å…¥ï¼š
localStorage.setItem('streamly-local-playlists', 'å¤‡ä»½æ•°æ®')
ç„¶ååˆ·æ–°é¡µé¢å³å¯ã€‚
      `;

      alert(instructions);
    }

    // æ»šåŠ¨åˆ°å­˜å‚¨ä¿¡æ¯åº•éƒ¨çš„å‡½æ•°
    function scrollToStorageBottom() {
      const content = document.getElementById('storageInfoContent');
      const modalBody = content ? content.closest('.modal-body') : null;

      if (modalBody) {
        // æ»šåŠ¨åˆ°åº•éƒ¨
        modalBody.scrollTop = modalBody.scrollHeight;
        console.log('ğŸ“œ å·²æ»šåŠ¨åˆ°å­˜å‚¨ä¿¡æ¯åº•éƒ¨');
      }
    }

    // ç¡®ä¿å¼¹çª—åº•éƒ¨å†…å®¹å¯è§
    function ensureModalBottomVisible() {
      const modal = document.getElementById('quickCreatePlaylistModal');
      const modalContent = modal ? modal.querySelector('.modal-content') : null;
      const modalFooter = modalContent ? modalContent.querySelector('.modal-footer') : null;

      if (modal && modalContent && modalFooter) {
        // æ£€æŸ¥å¼¹çª—æ˜¯å¦è¶…å‡ºå±å¹•é«˜åº¦
        const modalRect = modalContent.getBoundingClientRect();
        const viewportHeight = window.innerHeight;

        if (modalRect.bottom > viewportHeight - 20) {
          // å¦‚æœå¼¹çª—åº•éƒ¨è¶…å‡ºå±å¹•ï¼Œè°ƒæ•´ä½ç½®
          modal.style.alignItems = 'flex-start';
          modal.style.paddingTop = '20px';
          modal.style.paddingBottom = '20px';

          console.log('âœ… å·²è°ƒæ•´å¼¹çª—ä½ç½®ä»¥ç¡®ä¿åº•éƒ¨å¯è§');
        }
      }
    }

    // å…¨å±€è°ƒè¯•å‡½æ•°
    window.debugStorageInfo = function() {
      const content = document.getElementById('storageInfoContent');
      const modalBody = content ? content.closest('.modal-body') : null;

      if (content && modalBody) {
        const allItems = content.querySelectorAll('li');
        const lastItem = allItems[allItems.length - 1];

        console.log('=== å­˜å‚¨ä¿¡æ¯è°ƒè¯• ===');
        console.log('æ€»é¡¹ç›®æ•°:', allItems.length);
        console.log('å†…å®¹é«˜åº¦:', content.scrollHeight);
        console.log('æ¨¡æ€æ¡†ä¸»ä½“é«˜åº¦:', modalBody.clientHeight);
        console.log('æ»šåŠ¨ä½ç½®:', modalBody.scrollTop);
        console.log('æœ€å¤§æ»šåŠ¨:', modalBody.scrollHeight - modalBody.clientHeight);

        if (lastItem) {
          console.log('æœ€åä¸€é¡¹æ–‡æœ¬:', lastItem.textContent);
          const rect = lastItem.getBoundingClientRect();
          const modalRect = modalBody.getBoundingClientRect();
          console.log('æœ€åä¸€é¡¹å¯è§:', rect.bottom <= modalRect.bottom);
        }

        return {
          totalItems: allItems.length,
          contentHeight: content.scrollHeight,
          modalHeight: modalBody.clientHeight,
          scrollTop: modalBody.scrollTop,
          maxScroll: modalBody.scrollHeight - modalBody.clientHeight,
          lastItemText: lastItem ? lastItem.textContent : 'none'
        };
      }

      return null;
    };

    // å¼ºåˆ¶æ˜¾ç¤ºæ‰€æœ‰å†…å®¹çš„å‡½æ•°
    window.forceShowAllStorageInfo = function() {
      const modal = document.getElementById('quickCreatePlaylistModal');
      const modalContent = modal ? modal.querySelector('.modal-content') : null;
      const modalBody = modalContent ? modalContent.querySelector('.modal-body') : null;

      if (modalBody) {
        modalBody.style.maxHeight = '80vh';
        modalBody.style.overflowY = 'auto';
        console.log('âœ… å·²å¼ºåˆ¶è®¾ç½®æ¨¡æ€æ¡†ä¸»ä½“é«˜åº¦');

        // å±•å¼€å­˜å‚¨ä¿¡æ¯
        const content = document.getElementById('storageInfoContent');
        if (content && content.style.display === 'none') {
          toggleStorageInfo();
        }

        // æ»šåŠ¨åˆ°åº•éƒ¨
        setTimeout(() => {
          scrollToStorageBottom();
        }, 300);
      }
    };

    // å…¨å±€æ¢å¤æ’­æ”¾åŒºå‡½æ•°
    window.restoreFooter = function() {
      console.log('ğŸ”§ å…¨å±€æ¢å¤æ’­æ”¾åŒº...');
      const footer = document.querySelector('footer');

      if (footer) {
        footer.style.display = 'flex';
        footer.style.visibility = 'visible';
        footer.style.opacity = '1';
        footer.style.position = 'relative';
        footer.style.zIndex = '1000';
        footer.style.minHeight = '300px';
        footer.style.height = 'auto';

        console.log('âœ… æ’­æ”¾åŒºå·²å…¨å±€æ¢å¤');
        return true;
      } else {
        console.error('âŒ æœªæ‰¾åˆ°footerå…ƒç´ ');
        return false;
      }
    };

    // æ£€æŸ¥æ’­æ”¾åŒºçŠ¶æ€çš„å‡½æ•°
    window.checkFooterStatus = function() {
      const footer = document.querySelector('footer');

      if (footer) {
        const computedStyle = window.getComputedStyle(footer);
        const status = {
          exists: true,
          display: footer.style.display || computedStyle.display,
          visibility: footer.style.visibility || computedStyle.visibility,
          opacity: footer.style.opacity || computedStyle.opacity,
          zIndex: footer.style.zIndex || computedStyle.zIndex
        };

        console.log('ğŸ“Š æ’­æ”¾åŒºçŠ¶æ€:', status);
        return status;
      } else {
        console.error('âŒ æœªæ‰¾åˆ°footerå…ƒç´ ');
        return { exists: false };
      }
    };

    // å¼ºåˆ¶ä¿®å¤æ’­æ”¾åŒºé«˜åº¦çš„å‡½æ•°
    window.fixFooterHeight = function() {
      console.log('ğŸ”§ å¼ºåˆ¶ä¿®å¤æ’­æ”¾åŒºé«˜åº¦...');
      const footer = document.querySelector('footer');

      if (footer) {
        // ç§»é™¤æ‰€æœ‰å¯èƒ½çš„é«˜åº¦é™åˆ¶
        footer.style.height = '';
        footer.style.maxHeight = '';
        footer.style.minHeight = '300px';

        // ç¡®ä¿æ­£ç¡®çš„æ˜¾ç¤ºå±æ€§
        footer.style.display = 'flex';
        footer.style.visibility = 'visible';
        footer.style.opacity = '1';
        footer.style.position = 'relative';
        footer.style.zIndex = '1000';

        // å¼ºåˆ¶é‡æ–°è®¡ç®—å¸ƒå±€
        footer.offsetHeight;

        console.log('âœ… æ’­æ”¾åŒºé«˜åº¦å·²å¼ºåˆ¶ä¿®å¤');
        console.log('ğŸ“ å½“å‰é«˜åº¦:', footer.offsetHeight + 'px');
        return footer.offsetHeight;
      } else {
        console.error('âŒ æœªæ‰¾åˆ°footerå…ƒç´ ');
        return 0;
      }
    };

    // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨ä¿®å¤footeré«˜åº¦
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        fixFooterHeight();
      }, 1000);

      // åˆå§‹åŒ–æœç´¢æŒ‰é’®åŠŸèƒ½
      initializeSearchButton();
    });

    // åˆå§‹åŒ–æœç´¢æŒ‰é’®åŠŸèƒ½
    function initializeSearchButton() {
      const searchBtn = document.getElementById('searchButton');
      const inputBox = document.getElementById('inputBox');

      if (searchBtn && inputBox) {
        // ç‚¹å‡»æœç´¢æŒ‰é’®æ—¶æ‰§è¡Œæœç´¢
        searchBtn.addEventListener('click', function(e) {
          e.preventDefault();
          performSearch();
        });

        // å›è½¦é”®æœç´¢
        inputBox.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            performSearch();
          }
        });

        // è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶æœç´¢æŒ‰é’®é«˜äº®
        inputBox.addEventListener('focus', function() {
          searchBtn.style.background = 'linear-gradient(135deg, #29b6f6, #0288d1)';
          searchBtn.style.boxShadow = '0 4px 15px rgba(79, 195, 247, 0.5)';
        });

        // è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹æ—¶æœç´¢æŒ‰é’®æ¢å¤
        inputBox.addEventListener('blur', function() {
          searchBtn.style.background = 'linear-gradient(135deg, #4fc3f7, #29b6f6)';
          searchBtn.style.boxShadow = '0 2px 8px rgba(79, 195, 247, 0.3)';
        });

        console.log('âœ… æœç´¢æŒ‰é’®åŠŸèƒ½å·²åˆå§‹åŒ–');
      }
    }

    // æ‰§è¡Œæœç´¢çš„å‡½æ•°
    function performSearch() {
      const inputBox = document.getElementById('inputBox');
      const searchBtn = document.getElementById('searchButton');

      if (inputBox && inputBox.value.trim()) {
        console.log('ğŸ” å¼€å§‹æœç´¢:', inputBox.value.trim());

        // æ·»åŠ æœç´¢æŒ‰é’®çš„åŠ è½½åŠ¨ç”»
        if (searchBtn) {
          searchBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
          searchBtn.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
        }

        // è°ƒç”¨åŸæœ‰çš„æœç´¢å‡½æ•°
        if (typeof input === 'function') {
          input(0);
        }

        // æ¢å¤æœç´¢æŒ‰é’®
        setTimeout(() => {
          if (searchBtn) {
            searchBtn.innerHTML = '<i class="fas fa-search"></i>';
            searchBtn.style.background = 'linear-gradient(135deg, #4fc3f7, #29b6f6)';
          }
        }, 1000);
      } else {
        // è¾“å…¥æ¡†ä¸ºç©ºæ—¶çš„æç¤º
        if (inputBox) {
          inputBox.focus();
          inputBox.style.borderColor = '#ff5722';
          inputBox.style.boxShadow = '0 0 10px rgba(255, 87, 34, 0.3)';

          setTimeout(() => {
            inputBox.style.borderColor = 'rgba(79, 195, 247, 0.3)';
            inputBox.style.boxShadow = '';
          }, 2000);
        }

        console.log('âš ï¸ è¯·è¾“å…¥æœç´¢å…³é”®è¯');
      }
    }

    // å¼ºåˆ¶ç¡®ä¿æ¨¡æ€æ¡†åœ¨æœ€é¡¶å±‚çš„å‡½æ•°
    window.forceModalToTop = function() {
      const modal = document.getElementById('quickCreatePlaylistModal');
      if (modal) {
        // è®¾ç½®ç»å¯¹æœ€é«˜çš„z-index
        modal.style.zIndex = '2147483647';
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.right = '0';
        modal.style.bottom = '0';
        modal.style.width = '100vw';
        modal.style.height = '100vh';

        // è®¾ç½®æ‰€æœ‰å­å…ƒç´ çš„z-index
        const allElements = modal.querySelectorAll('*');
        allElements.forEach(element => {
          element.style.zIndex = '2147483647';
          element.style.position = 'relative';
        });

        console.log('âœ… æ¨¡æ€æ¡†å·²å¼ºåˆ¶ç½®é¡¶');
        return true;
      }
      return false;
    };

    // ç›‘å¬æ¨¡æ€æ¡†æ˜¾ç¤ºï¼Œè‡ªåŠ¨è®¾ç½®æœ€é«˜å±‚çº§
    function setupModalObserver() {
      const modal = document.getElementById('quickCreatePlaylistModal');
      if (modal) {
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
              if (modal.style.display === 'flex' || modal.style.display === 'block') {
                setTimeout(() => {
                  forceModalToTop();
                }, 10);
              }
            }
          });
        });

        observer.observe(modal, {
          attributes: true,
          attributeFilter: ['style']
        });

        console.log('âœ… æ¨¡æ€æ¡†è§‚å¯Ÿå™¨å·²è®¾ç½®');
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåè®¾ç½®è§‚å¯Ÿå™¨
    document.addEventListener('DOMContentLoaded', function() {
      setupModalObserver();

      // ç«‹å³æ£€æŸ¥å¹¶å¼ºåˆ¶è®¾ç½®æ¨¡æ€æ¡†å±‚çº§
      setTimeout(() => {
        forceModalToTop();
      }, 100);
    });

    // é‡å†™showCreatePlaylistDialogå‡½æ•°ä»¥ç¡®ä¿å±‚çº§
    const originalShowCreatePlaylistDialog = window.showCreatePlaylistDialog;
    window.showCreatePlaylistDialog = function() {
      if (originalShowCreatePlaylistDialog) {
        originalShowCreatePlaylistDialog.apply(this, arguments);
      }

      // å¼ºåˆ¶è®¾ç½®æœ€é«˜å±‚çº§
      setTimeout(() => {
        forceModalToTop();
      }, 50);
    };
  </script>
</body>
</html>
